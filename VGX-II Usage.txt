VGX Block Cipher
Multi-mode operation: ecb, ofb, ctr
3 security levels: very weak, legacy weak, strong (weakness none)

Requirements: Python 3.6+

VGX is an educational 64-bit Feistel-style block cipher created for experimental laboratory use and cryptographic research exercises.
It is not intended for commercial protection of sensitive information. VGX exists to provide a model cipher that is structurally recognizable to cryptographers, modifiable for testing, and analyzable under different security-relevant parameters.


Usage

To encrypt
vgx.py --mode encrypt --ciphermode ofb --key 78a253d1faed0e4c --cue "1 88 199 252 77 12 7 179" --plain 00000000000000000000000000000000 --weakness none --iv eafd20a357db14cf 

To decrypt
vgx.py --mode decrypt --ciphermode ofb --key 78a253d1faed0e4c --cue "1 88 199 252 77 12 7 179" --cipher 1cc4bc5f7d24c30b48fc6717ca67b613 --weakness none --iv eafd20a357db14cf


Options

--ciphermode ecb  ofb  ctr
--key        8 bytes hex (no parity restriction)
--cue        8 blocks decimal (0-255)
--weakness   very_weak  legacy_weak  none 
--rounds     very weak and legacy weak default= 8. weakness none (strong) default= 16
--iv         8 bytes hex
--verbose    prints round details and subkeys for encryption and decryption

Weakness Mode Notes:
very_weak	       Simple XOR and rotate; subkeys repeat quickly. Vulnerable to basic attacks like differential cryptanalysis.
legacy_weak	     Key schedule weakens early; subkeys partially repeat. Provides roughly RC2-era security.
none             Strong mode, with a dynamic, cryptographically secure S-box based on key and cue.


What does the cue do?

The cue influences how the cipher operates and how subkeys are generated for encryption and decryption. Its role varies depending on the selected weakness setting:

Very Weak Mode (very_weak)
Cue's Role: In this mode, the cue is used in a very basic manner to generate subkeys. It is directly mixed with the key in a simple XOR-based operation.

Details: The cue contributes to the subkey generation by interacting with the key through a weak transformation. The weak transformation involves applying the cue in such a way that the result is easily predictable and not cryptographically strong. Specifically, it helps generate subkeys through a combination of key and cue values in a way that is not resistant to attacks like brute force or differential cryptanalysis.

Weakness: The "very weak" mode introduces a significant amount of predictability and vulnerabilities into the cipher, making it unsuitable for secure encryption but useful for educational purposes in understanding weak ciphers.

Legacy Weak Mode (legacy_weak)
Cue's Role: The cue is used in a more complex way compared to the very weak mode, though still not secure. In this mode, the cue affects the key schedule and subkey generation, but the transformations are slightly stronger than in the "very weak" mode.

Details: The cue is mixed with the key in a manner that includes XOR operations and rotations. However, these operations are still weak from a cryptographic standpoint. The result is a cipher that has slightly more complexity but still remains easily breakable by modern cryptanalysis techniques.

Weakness: While "legacy weak" mode adds more complexity to the transformation process, it still fails to provide real cryptographic strength and is therefore considered obsolete and insecure for any serious use.

None Mode (none)
Cue's Role: This mode is the strongest of the three. The cue is used to create a unique, strong S-box (substitution box) for the cipher. This makes the cipher much harder to break cryptographically compared to the "weak" modes.

Details: In this mode, the cue is used to modify an S-box (substitution box) that is derived from the key and the cue. This S-box is "strong" because it introduces high unpredictability and cryptographic strength, making it more resistant to attacks like differential cryptanalysis. The subkeys generated in this mode are much more robust than in the weak modes.

Strength: In this mode, the cue plays an important role in strengthening the cipher, as it helps create a dynamic and strong key schedule that provides resistance to modern cryptographic attacks.

